Continuous Delivery with DevSecOps Reference Architecture. <p><em>IBM provides a DevSecOps reference implementation which is especially useful for regulated industries to adhere to policies. This article describes the CD pipeline to deploy software using a GitOps approach.</em><span id="more-4963"></span></p>
<p>Here is the definition of <a href="https://cloud.ibm.com/docs/devsecops?topic=devsecops-devsecops_intro" rel="noopener noreferrer" target="_blank">DevSecOps</a> from IBM:</p>
<blockquote><p>DevSecOps is an evolution of Agile and DevOps, integrating secure development best practices as early as possible in the software delivery lifecycle (also known as &#8220;shift left&#8221;). This approach prevents security problems from reaching production systems and failing corporate audits. DevSecOps requires automating security and compliance controls as part of continuous integration and continuous delivery processes. Evidence of these controls is also collected to demonstrate to auditors that every change in history meets the necessary controls.</p></blockquote>
<p>This article is part of a mini series:</p>
<ul>
<li><a href="http://heidloff.net/article/devsecops-saas-reference-architecture-openshift/" rel="noopener noreferrer" target="_blank">DevSecOps for SaaS Reference Architecture on OpenShift</a></li>
<li><a href="http://heidloff.net/article/shift-left-continuous-integration-devsecops-pipelines/" rel="noopener noreferrer" target="_blank">Shift-Left Continuous Integration with DevSecOps Pipelines</a></li>
<li><a href="http://heidloff.net/article/change-evidence-issue-management-devsecops/" rel="noopener noreferrer" target="_blank">Change, Evidence and Issue Management with DevSecOps</a></li>
<li>This article: <a href="http://heidloff.net/article/continuous-delivery-ibm-devsecops-reference-architecture/" rel="noopener noreferrer" target="_blank">Continuous Delivery with DevSecOps Reference Architecture</a></li>
<li><a href="http://heidloff.net/article/tekton-without-tekton-devsecops-pipelines/" rel="noopener noreferrer" target="_blank">Tekton without Tekton in DevSecOps Pipelines</a></li>
</ul>
<p>In my previous <a href="http://heidloff.net/article/change-evidence-issue-management-devsecops/" rel="noopener noreferrer" target="_blank">blog</a> I explained the CI pipeline. The CI pipeline template that is part of IBM&#8217;s DevSecOps reference implementation builds and pushes images and runs various security and code tests. Only if all checks pass, the application can be deployed to production via the CD pipeline. This assures that new versions can be deployed at any time based on business (not technical) decisions.</p>
<p>The CD (continuous delivery) pipeline generates all of the evidence and change request summary content. The pipeline deploys the build artifacts to a specific environment and collects, creates, and uploads all existing log files, evidence, and artifacts to the evidence locker. Here is an overview of the <a href="https://cloud.ibm.com/docs/devsecops?topic=devsecops-cd-devsecops-cd-pipeline" rel="noopener noreferrer" target="_blank">functionality</a> provided by the CD pipeline:</p>
<ul>
<li>Determine deployment delta</li>
<li>Calculate deployment BOM</li>
<li>Collect evidence summary</li>
<li>Prepare and create change request</li>
<li>Check change request approval</li>
<li>Perform deployment</li>
<li>Run acceptance test</li>
</ul>
<p>Let&#8217;s take a look at a concrete sample. My team has developed a <a href="https://github.com/IBM/multi-tenancy" rel="noopener noreferrer" target="_blank">SaaS reference architecture</a> that shows how our clients and partners can build software as a service. While the compute components are identical for multiple platforms like Kubernetes, OpenShift and Serverless, the way these components are deployed is specific to the platforms.</p>
<p>Here is how the CD pipeline is used for Kubernetes and OpenShift deployments. In order to deploy a new application version for a specific tenant, a pull request has to be created and merged. The pull request asks to merge the latest version from the main branch of the inventory to the tenant specific branches in the inventory. After the latest version has been merged into the branch of a specific tenant, the deployment functionality of the DevSecOps reference implementation uses GitOps to deploy the application to the production environment of the tenant. This is done by comparing the actual &#8216;as is&#8217; state in the cluster with the &#8216;to be&#8217; state in the tenant branch.</p>
<p>Here are the key steps performed in the CD pipelines. For the complete flow read the documentation.</p>
<ul>
<li><a href="https://github.com/IBM/multi-tenancy-documentation/blob/main/documentation/kubernetes-via-ibm-kubernetes-service-and-ibm-openshift/cd-pull-request.md" rel="noopener noreferrer" target="_blank">Promotion pipeline</a>: The first CD pipeline is a very simple &#8216;pipeline&#8217; which only creates a pull request.</li>
<li><a href="https://github.com/IBM/multi-tenancy-documentation/blob/main/documentation/kubernetes-via-ibm-kubernetes-service-and-ibm-openshift/cd-pipeline.md" rel="noopener noreferrer" target="_blank">CD pipeline</a>: The second CD pipeline is the actual CD pipeline.</li>
</ul>
<p>Create the pull request to deploy the latest version for a specific tenant.</p>
<p><img src="http://heidloff.net/wp-content/uploads/2022/04/devsecops-cd-0.png" alt="" width="3840" height="2160" class="alignnone size-full wp-image-4965" srcset="http://heidloff.net/wp-content/uploads/2022/04/devsecops-cd-0.png 3840w, http://heidloff.net/wp-content/uploads/2022/04/devsecops-cd-0-300x169.png 300w, http://heidloff.net/wp-content/uploads/2022/04/devsecops-cd-0-768x432.png 768w, http://heidloff.net/wp-content/uploads/2022/04/devsecops-cd-0-1024x576.png 1024w" sizes="(max-width: 3840px) 100vw, 3840px" /></p>
<p>After defining all data, the pull request can be merged.</p>
<p><img src="http://heidloff.net/wp-content/uploads/2022/04/devsecops-cd-1.png" alt="" width="3840" height="2160" class="alignnone size-full wp-image-4966" srcset="http://heidloff.net/wp-content/uploads/2022/04/devsecops-cd-1.png 3840w, http://heidloff.net/wp-content/uploads/2022/04/devsecops-cd-1-300x169.png 300w, http://heidloff.net/wp-content/uploads/2022/04/devsecops-cd-1-768x432.png 768w, http://heidloff.net/wp-content/uploads/2022/04/devsecops-cd-1-1024x576.png 1024w" sizes="(max-width: 3840px) 100vw, 3840px" /></p>
<p>The actual CD pipeline (the second one) can be started in either of the following ways:</p>
<ul>
<li>Preferred: Trigger the CD pipeline manually.</li>
<li>Optional: Automatically after every merge action in the inventory repository</li>
</ul>
<p><img src="http://heidloff.net/wp-content/uploads/2022/04/devsecops-cd-3.png" alt="" width="3840" height="2160" class="alignnone size-full wp-image-4967" srcset="http://heidloff.net/wp-content/uploads/2022/04/devsecops-cd-3.png 3840w, http://heidloff.net/wp-content/uploads/2022/04/devsecops-cd-3-300x169.png 300w, http://heidloff.net/wp-content/uploads/2022/04/devsecops-cd-3-768x432.png 768w, http://heidloff.net/wp-content/uploads/2022/04/devsecops-cd-3-1024x576.png 1024w" sizes="(max-width: 3840px) 100vw, 3840px" /></p>
<p>Global and tenant specific configuration is read. Either Kubernetes or OpenShift can be used; in a shared cluster or isolated clusters for tentants.</p>
<p><img src="http://heidloff.net/wp-content/uploads/2022/04/devsecops-cd-4.png" alt="" width="3840" height="2160" class="alignnone size-full wp-image-4968" srcset="http://heidloff.net/wp-content/uploads/2022/04/devsecops-cd-4.png 3840w, http://heidloff.net/wp-content/uploads/2022/04/devsecops-cd-4-300x169.png 300w, http://heidloff.net/wp-content/uploads/2022/04/devsecops-cd-4-768x432.png 768w, http://heidloff.net/wp-content/uploads/2022/04/devsecops-cd-4-1024x576.png 1024w" sizes="(max-width: 3840px) 100vw, 3840px" /></p>
<p>The delta is calculated, since only changes are deployed. Additionally security checks are performed again.</p>
<p><img src="http://heidloff.net/wp-content/uploads/2022/04/devsecops-cd-5.png" alt="" width="3840" height="2160" class="alignnone size-full wp-image-4969" srcset="http://heidloff.net/wp-content/uploads/2022/04/devsecops-cd-5.png 3840w, http://heidloff.net/wp-content/uploads/2022/04/devsecops-cd-5-300x169.png 300w, http://heidloff.net/wp-content/uploads/2022/04/devsecops-cd-5-768x432.png 768w, http://heidloff.net/wp-content/uploads/2022/04/devsecops-cd-5-1024x576.png 1024w" sizes="(max-width: 3840px) 100vw, 3840px" /></p>
<p>After the actual deployment has been performed, data is collected.</p>
<p><img src="http://heidloff.net/wp-content/uploads/2022/04/devsecops-cd-6.png" alt="" width="3840" height="2160" class="alignnone size-full wp-image-4970" srcset="http://heidloff.net/wp-content/uploads/2022/04/devsecops-cd-6.png 3840w, http://heidloff.net/wp-content/uploads/2022/04/devsecops-cd-6-300x169.png 300w, http://heidloff.net/wp-content/uploads/2022/04/devsecops-cd-6-768x432.png 768w, http://heidloff.net/wp-content/uploads/2022/04/devsecops-cd-6-1024x576.png 1024w" sizes="(max-width: 3840px) 100vw, 3840px" /></p>
<p><img src="http://heidloff.net/wp-content/uploads/2022/04/devsecops-cd-7.png" alt="" width="3840" height="2160" class="alignnone size-full wp-image-4971" srcset="http://heidloff.net/wp-content/uploads/2022/04/devsecops-cd-7.png 3840w, http://heidloff.net/wp-content/uploads/2022/04/devsecops-cd-7-300x169.png 300w, http://heidloff.net/wp-content/uploads/2022/04/devsecops-cd-7-768x432.png 768w, http://heidloff.net/wp-content/uploads/2022/04/devsecops-cd-7-1024x576.png 1024w" sizes="(max-width: 3840px) 100vw, 3840px" /></p>
<p><img src="http://heidloff.net/wp-content/uploads/2022/04/devsecops-cd-8.png" alt="" width="3840" height="2160" class="alignnone size-full wp-image-4972" srcset="http://heidloff.net/wp-content/uploads/2022/04/devsecops-cd-8.png 3840w, http://heidloff.net/wp-content/uploads/2022/04/devsecops-cd-8-300x169.png 300w, http://heidloff.net/wp-content/uploads/2022/04/devsecops-cd-8-768x432.png 768w, http://heidloff.net/wp-content/uploads/2022/04/devsecops-cd-8-1024x576.png 1024w" sizes="(max-width: 3840px) 100vw, 3840px" /></p>
<p>Check out the <a href="https://cloud.ibm.com/docs/devsecops?topic=devsecops-tutorial-cd-devsecops" rel="noopener noreferrer" target="_blank">IBM Toolchains documentation</a> and the <a href="https://github.com/IBM/multi-tenancy" rel="noopener noreferrer" target="_blank">SaaS reference architecture</a> to find out more.</p>
<p>The post <a rel="nofollow" href="http://heidloff.net/article/continuous-delivery-ibm-devsecops-reference-architecture/">Continuous Delivery with DevSecOps Reference Architecture</a> appeared first on <a rel="nofollow" href="http://heidloff.net">Niklas Heidloff</a>.</p>
